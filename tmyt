#!/bin/bash
index=$(curl -s "https://www.youtube.com/results?search_query=$1")
x=($(grep -o "rer\":{\"videoId\":\"[a-zA-Z0-9_-]*..." <<< $index | sed -e 's/rer"\:{"videoId":"//g' -e 's/","//g'))
t=($(grep -o '}\]},"title":{"runs":\[{"text":"[^"]*' <<< $index | sed -e 's/}\]},"title"\:{"runs"\:\[{"text"\:"//g' -e 's/ /_/g'))
n=0
for video in ${t[@]};
do
	args+=("$n" " $video")
	n=$(($n+1))
done
num=$(whiptail --title "Terminal YT Client" --menu "Choose video to watch" 25 100 18 ${args[@]} 3>&1 1>&2 2>&3)
mpv --ytdl-format="bestvideo[height<=?720]+bestaudio/best" "https://www.youtube.com/watch?v=${x[$num]}"
